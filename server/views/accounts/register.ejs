<div class="container bg-stone-800 mx-auto max-w-md p-6 shadow rounded-xl">
    <h1 class="text-2xl font-bold mb-6 text-center">Créer un compte</h1>

    <form name="accountCreation" action="/register" method="POST" class="space-y-4">
        <div class="flex flex-col">
            <label for="username" class="font-semibold mb-1">Nom d'utilisateur</label>
            <input id="username" name="username" value="<%= locals.username ?? '' %>" class="border px-3 py-2 rounded" required>
            <span class="text-red-500 text-sm mt-1"><%= locals.message ?? '' %></span>
        </div>

        <div class="flex flex-col">
            <label for="password" class="font-semibold mb-1">Mot de passe</label>
            <input id="password" type="password" name="password" class="border px-3 py-2 rounded" required>
            <span id="passwordMessage" class="text-red-500 text-sm mt-1"></span>
        </div>

        <div class="flex flex-col">
            <label for="passwordRepeated" class="font-semibold mb-1">Confirmez le mot de passe</label>
            <input id="passwordRepeated" type="password" class="border px-3 py-2 rounded" required>
            <span id="passwordRepeatedMessage" class="text-red-500 text-sm mt-1"></span>
        </div>

        <div class="text-center">
            <input type="submit" value="Créer le compte" class="px-4 py-2 bg-green-600 rounded hover:bg-green-700 cursor-pointer">
        </div>
    </form>
</div>

<script>
    const accountForm = document.forms.accountCreation;
    accountForm.addEventListener("submit", (e) => {
        e.preventDefault();
        validateAccountCreation(accountForm);
    });

    function validateAccountCreation(accountForm) {
        const passwordMessage = document.getElementById("passwordMessage");
        const passwordRepeated = document.getElementById("passwordRepeated");
        const passwordRepeatedMessage = document.getElementById("passwordRepeatedMessage");

        passwordMessage.textContent = "";
        passwordRepeatedMessage.textContent = "";

        if (accountForm.password.value.length < 8) {
            passwordMessage.textContent = "Le mot de passe doit contenir au moins 8 caractères.";
        } else if (accountForm.password.value !== passwordRepeated.value) {
            passwordRepeatedMessage.textContent = "Les mots de passe ne correspondent pas.";
        } else {
            accountForm.submit();
        }
    }
</script>
