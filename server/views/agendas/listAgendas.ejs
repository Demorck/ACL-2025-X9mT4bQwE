<% layout('template/layout') %>
<div class="inner-container mx-auto md:w-3/4 lg:w-2/3 w-full rounded-xl my-4 py-6">
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 px-4 mb-6">
    <h1 class="text-3xl font-bold">Mes agendas</h1>
    
    <div class="flex flex-wrap gap-2">
      <button data-action="new" class="flex items-center gap-2 px-4 py-2 cursor-pointer bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm font-medium">
        <i class="fa fa-plus"></i>
        <span>Nouvel agenda</span>
      </button>
      <button data-action="import" class="flex items-center gap-2 px-4 py-2 cursor-pointer bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors shadow-sm font-medium">
        <i class="fa fa-upload"></i>
        <span>Importer</span>
      </button>
    </div>
  </div>

  <% if (agendas && agendas.length) { %>
    <div class="list-agendas space-y-3 px-4">
      <% agendas.forEach(a => { %>
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 p-4 rounded-lg  transition-colors"
            data-agenda="<%= a._id %>">
          
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-1">
              <span class="inline-block w-3 h-3 rounded-full filter-color-<%= a.couleur %>"></span>
              <p class="font-semibold text-lg"><%= a.nom %></p>
              <% if(user._id.toString() !== a.user._id.toString()) { %>
                <span class="text-xs px-2 py-1 bg-blue-500/20 text-blue-400 rounded">Partagé</span>
              <% } %>
            </div>
            <% if (a.description) { %>
              <p class="text-sm opacity-75 ml-5"><%= a.description %></p>
            <% } %>
          </div>

          <div class="flex flex-wrap gap-2">
            <button class="flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer bg-blue-600 hover:bg-blue-700 text-white text-sm transition-colors font-medium" 
                    data-action="invite"
                    title="Gérer les invitations">
              <i class="fa fa-user-plus"></i>
              <span class="hidden sm:inline">Invitations</span>
            </button>
            
            <% if(user._id.toString() === a.user._id.toString()) { %>
              <button class="flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer bg-amber-600 hover:bg-amber-700 text-white text-sm transition-colors font-medium" 
                      data-action="edit"
                      title="Modifier l'agenda">
                <i class="fa fa-edit"></i>
                <span class="hidden sm:inline">Modifier</span>
              </button>
              
              <button class="flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer bg-purple-600 hover:bg-purple-700 text-white text-sm transition-colors font-medium" 
                      data-action="export"
                      title="Exporter l'agenda">
                <i class="fa fa-download"></i>
                <span class="hidden sm:inline">Exporter</span>
              </button>
            <% } else { %>
              <button data-action="leave"
                      class="flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer bg-red-600 hover:bg-red-700 text-white text-sm transition-colors font-medium"
                      title="Quitter cet agenda">
                <i class="fa fa-sign-out"></i>
                <span class="hidden sm:inline">Quitter</span>
              </button>
            <% } %>
          </div>
        </div>
      <% }) %>
    </div>
  <% } else { %>
    <div class="text-center py-12 px-4">
      <i class="fa fa-calendar text-5xl opacity-30 mb-4"></i>
      <p class="text-lg opacity-75">Aucun agenda pour le moment</p>
      <p class="text-sm opacity-50 mt-2">Créez votre premier agenda pour commencer</p>
    </div>
  <% } %>
</div>
