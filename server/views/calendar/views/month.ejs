<% layout('calendar/layout_calendar') %>

<div class="flex flex-col flex-1 h-full bg-stone-900 text-stone-100">
  <div class="flex flex-1 flex-col border border-stone-700 rounded overflow-hidden">

    <div class="flex flex-row">
        <% const weekDays = ["Lun", "Mar", "Mer", "Jeu", "Ven", "Sam", "Dim"]; %>
        <% weekDays.forEach(day => { %>
        <div class="bg-stone-800 text-center py-2 font-semibold border-b border-stone-700 flex-1">
            <%= day %>
        </div>
        <% }) %>
    </div>

    <% data.days.forEach(week => { %>
        <div class="flex flex-row flex-1">
            <% week.forEach(day => { %>
                <div class="flex flex-1">
                    <div class="relative w-full border-r flex-1 border-b border-stone-800 p-2 bg-stone-800/50">
                        <div class="text-sm text-stone-400">
                            <%= day.getDate() %>
                        </div>
                        <div class="flex flex-1 flex-col gap-1 mt-1">
                        <% let appointments = data.appointments.filter(a => a.start.getDate() == day.getDate()); 
                            appointments.forEach(app => {
                            %>
                            <a href="/calendar/day" class="text-xs truncate px-2 py-1 rounded bg-<%=app.color%>-500/80 text-stone-900 hover:bg-<%=app.color%>-400 transition appointment-month"
                                  data-agenda="<%= app.agendaId %>"  >
                            <%= app.nom %>
                            </a>
                        <% }) %>
                        </div>
                        <% if (day.getMonth() != data.requestedMonth) { %>
                        <div class="absolute inset-0 bg-stone-900/60 pointer-events-none"></div>
                        <% } %>
                    </div>
                </div>
            <% }) %> 
        </div> 
    <% }) %>

  </div>
</div>
