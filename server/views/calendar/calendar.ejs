<div class="container mx-auto max-w-4xl px-4">
    <% const prevMonth = month === 0 ? 11 : month - 1; %>
    <% const nextMonth = month === 11 ? 0 : month + 1; %>
    <% const prevYear = month === 0 ? year - 1 : year; %>
    <% const nextYear = month === 11 ? year + 1 : year; %>

    <div class="flex items-center justify-between mb-6">
        <a href="/agendas?month=<%= prevMonth %>&year=<%= prevYear %>" class="px-3 py-2 bg-stone-800 rounded hover:bg-stone-600">←</a>
        <h1 class="text-2xl font-bold"><%= monthName %> <%= year %></h1>
        <a href="/agendas?month=<%= nextMonth %>&year=<%= nextYear %>" class="px-3 py-2 bg-stone-800 rounded hover:bg-stone-600">→</a>
    </div>

    <div class="grid grid-cols-7 text-center font-semibold border-b pb-2 mb-2">
        <div>Lun</div>
        <div>Mar</div>
        <div>Mer</div>
        <div>Jeu</div>
        <div>Ven</div>
        <div>Sam</div>
        <div>Dim</div>
    </div>

    <div class="grid grid-cols-7 gap-2">
        <% // j'sais pas si je mets ça dans la vue ou dans le modèle
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            for (let day = 1; day <= daysInMonth; day++) { 
            const dateKey = `${year}-${(month + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
            const colors = appointmentsByDay[dateKey] ? Array.from(appointmentsByDay[dateKey]) : [];
        %>

        <div class="p-2 text-center border rounded-xl bg-stone-700 hover:bg-stone-600">
            <a href="/daily?day=<%= day %>&month=<%= month %>&year=<%= year %>" class="block text-stone-50 font-semibold">
            <%= day %>
            <div class="flex justify-center gap-1 mt-1">
            <% if (colors.length > 0) { %>
                <% colors.slice(0, 3).forEach(color => { %>
                <span class="w-2 h-2 rounded-full  bg-<%= color %>-500"></span>
                <% }) %>
                <% if (colors.length > 3) { %>
                <span class="text-xs text-gray-300">+</span>
                <% } %>
            <% } else { %>
                <span class="w-2 h-2 rounded-full"></span>


            <% } %>
            </div>
            </a>
        </div>
        <% } %>
    </div>



</div>