<% 
  const dayName = new Date(year, month, day)
    .toLocaleDateString('fr-FR', { weekday: 'long' })
    .replace(/^./, c => c.toUpperCase());
%>

<div class="flex justify-between items-center mb-6">
  <a href="/agendas?month=<%= month %>&year=<%= year %>" class="px-3 py-2 bg-stone-800 rounded hover:bg-stone-600">Retour</a>
  <h1 class="text-2xl font-bold"><%= dayName %> <%= day %>/<%= month+1 %>/<%= year %></h1>
  <a href="/appointment/new?day=<%= day %>&month=<%= month %>&year=<%= year %>" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-400">+ Ajouter</a>
</div>


<div class="relative border border-stone-800 rounded bg-stone-700 overflow-hidden flex flex-1" style="height: 1200px;">
  <div class="absolute left-0 top-0 w-16 h-full border-r border-stone-600 bg-stone-800">
    <% for (let h = 0; h < 24; h++) { %>
      <div 
        class="absolute text-stone-300 text-xs text-right pr-2"
        style="top: calc(<%= (h / 24) * 100 %>%); height: calc(100% / 24); width: 100%;">
        <%= h.toString().padStart(2, "0") %>h
      </div>
    <% } %>
  </div>

  <div class="absolute left-16 top-0 right-0 h-full">
    <% for (let h = 0; h < 24; h++) { %>
      <div 
        class="absolute left-0 right-0 border-t border-stone-600 <%= h % 2 === 0 ? 'bg-stone-600/20' : '' %>"
        style="top: calc(<%= (h / 24) * 100 %>%); height: calc(100% / 24);">
      </div>
    <% } %>

    <% appointments.forEach(app => { %>
      <div 
        class="absolute bg-yellow-700 border border-yellow-300 rounded px-3 py-2 text-sm text-white shadow-md overflow-hidden hover:bg-yellow-600"
        style="
          top: calc(<%= (app.startHour / 24) * 100%>%);
          height: calc((<%= app.durationHours %> / 24) * 100%>%);
          left: calc(<%= (app.colIndex / app.colCount) * 100%>%);
          width: calc(<%= (1 / app.colCount) * 100%>%);
        ">
        <strong><%= app.nom %></strong><br>
        <%= app.startLabel %> - <%= app.endLabel %>
      </div>
    <% }) %>
  </div>
</div>
